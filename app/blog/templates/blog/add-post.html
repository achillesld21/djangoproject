{% extends "base.html" %}
{% load static %}

{% block page_title %}ADD BLOG{% endblock %}

{% block css_file  %}
    <link rel="stylesheet" href="{% static "blog/index.css" %}"/>
{% endblock %}
{% block back_url %}
<li class="nav-item"><a href="{% url "starting-page"%}" class="nav-link" aria-current="page">
    <button type="button" class="btn btn-outline-secondary btn-sm" >
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"></path>
  </svg>
      <span>Go Back</span>
      </button>
  </a></li>
{% endblock %}

{% block page_content %}
<div class="container">
<form method="POST" action="http://0.0.0.0:8000/addpost" enctype="multipart/form-data" id="data">
    <input type="hidden" name="csrfmiddlewaretoken" value="7hzZXp1VDe0HKmJhhPPiwp6lS7hLyXyDCOZrqinhJoAIdQurHhaQhKyVE1uY1EgI">
   
       <label for="id_category">Category:</label>
       
         
         <input type="text" name="category" class="form-control" maxlength="20" required="" id="id_category">   
     
     
       <label for="id_heading">Heading:</label>
       
         
         <input type="text" name="heading" class="form-control" maxlength="50" required="" id="id_heading">
         
   
     
       <label for="id_content">Content:</label>
       
         
         <textarea name="content" cols="40" rows="10" class="form-control" required="" id="id_content"></textarea>
         
     
       <label for="id_image">Image:</label>
       
         
         <input type="file" name="image" accept="image/*" id="id_image">
         
       
     
   <button type="submit" id="submit" class="btn btn-primary"> Save </button>
   </form>
</div>
{% endblock %}

{% block script %}
 <script language="JavaScript">
    $(document).ready(function() {

        $("form#data").submit(function(e) {
            e.preventDefault(); 
            var token = localStorage.getItem('token');   
            var formData = new FormData(this);
        
            $.ajax({
                url: $(this).attr('action'),
                type: 'POST',
                data: formData,
                headers: {
                    'Authorization': `Bearer ${token}`,
                },
                success: function (data) {
                    alert("Blog added successfully");
                    window.location = "http://0.0.0.0:8000/";
                    
                    
                },
                cache: false,
                contentType: false,
                processData: false
            });
        });
    });
</script>
{% endblock  %}