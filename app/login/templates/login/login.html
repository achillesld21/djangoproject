{% extends "base2.html" %}
{% load static %}
{% block page_title %}LOGIN{% endblock %}

{% block css_file  %}
    <link rel="stylesheet" href="{% static "blog/index.css" %}"/>
{% endblock %}

{% block page_content %}

<div class="container">
	<h1>Login</h1>
<br/>


		<form action="login_api" id="loginData" method=POST>
			{% csrf_token %}

		<form>
  <div class="mb-3">
    <label for="exampleInputEmail1" class="form-label">Username</label>
    <input type="text" class="form-control" name="username" aria-describedby="emailHelp">
    
  </div>
  <div class="mb-3">
    <label for="exampleInputPassword1" class="form-label">Password</label>
    <input type="password" class="form-control" name="password">
  </div>
  


			

		<input type="submit" value="Submit" class="btn btn-secondary">
    <a href="{% url "register_user" %}" class="btn btn-outline-secondary btn px-4" aria-current="page">New User ?</a>
		</form>
		

<br/><br/>	
</div>

{% endblock %}
{% block script %}
 <script language="JavaScript">
    $(document).ready(function() {

        $("form#loginData").submit(function(e) {
            e.preventDefault();    
            var formData = new FormData(this);
        
            $.ajax({
                url: $(this).attr('action'),
                type: 'POST',
                data: formData,
                success: function (data) {
                  
                    localStorage.setItem('token', data.access_token);
                    localStorage.setItem('refresh', data.refresh_token);
                    window.location = "http://0.0.0.0:8000/"                    
                    
                },
                cache: false,
                contentType: false,
                processData: false
            });
        });
    });
</script>
{% endblock  %}